name: Malware Network Traffic
{% raw %}
alert_subject: "{0} - {1}"
{% endraw %}
alert_subject_args:
- alert.signature
- source.ip

# (Required)
# Type of alert.
# the frequency rule type alerts when num_events events occur with timeframe time
# The any rule will match everything. Every hit that the query returns will generate an alert.
type: any

{# realert:
  hours: 4 #}

timeframe:
  minutes: 1

# (Required)
# Index to search, wildcard supported
index: suricata-*

# (Required, new_term specific)
# Monitor the field ip_address
#fields:
# - "source.ip"

filter:
- query:
    query_string:
      #query: "(alert.signature:\"ET TROJAN\" OR alert.signature:\"ET CURRENT EVENTS\" OR alert.signature:\"ET MALWARE\" OR alert.signature:\"ET MOBILE MALWARE\" OR alert.signature:\"ET CNC\") AND (alert.signature:*ransom* OR alert.signature:*crypto* OR alert.signature:\"check-in\" OR alert.signature:checkin OR alert.signature:download* OR alert.signature:DL OR alert.signature:macro OR alert.signature:cnc OR alert.signature:dropper OR alert.signature:beacon OR alert.signature:backdoor OR alert.signature:c2 OR alert.signature:m2)"
      query: "alert.signature: \"ET\""

{% include "application/alert_email_conf.yaml.j2" %}
